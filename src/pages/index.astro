---
import Layout from "../layouts/Layout.astro";
import HeroSection from "../components/HeroSection.astro";
import ArticleCard from "../components/ArticleCard.astro";
import NewsCard from "../components/NewsCard.astro";
import { getCollection } from "astro:content";

const articles = (await getCollection("articles"))
  .filter((article) => !article.data.isDraft)
  .sort((a, b) => b.data.publishedAt.getTime() - a.data.publishedAt.getTime())
  .slice(0, 3);

const news = (await getCollection("news"))
  .sort((a, b) => b.data.publishedAt.getTime() - a.data.publishedAt.getTime())
  .slice(0, 3);
---

<Layout title="ホーム">
  <main>
    <HeroSection />

    <section>
      <h2><a href="/articles">最新記事 &rarr;</a></h2>
      <div class="card-grid">
        {articles.map((article) => <ArticleCard article={article} />)}
      </div>
      <div class="view-all"></div>
    </section>

    <section>
      <h2><a href="/news">最新ニュース &rarr;</a></h2>
      <div class="card-grid">
        {news.map((newsItem) => <NewsCard newsItem={newsItem} />)}
      </div>
    </section>
  </main>

  <style>
    main {
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem 1rem;
    }

    section {
      margin-bottom: 4rem;
    }

    h2 {
      font-size: 2.5rem;
      text-align: center;
      margin-bottom: 2rem;
    }

    h2 a {
      color: var(--black);
      text-decoration: none;
    }

    .card-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 2rem;
    }
  </style>
</Layout>
